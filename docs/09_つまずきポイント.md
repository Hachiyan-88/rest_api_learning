<!-- markdownlint-disable MD033 -->
# つまずきポイント集

このページでは、
>実際にAPIを作り始めたときに「ここで止まる」ポイント

を整理していきます。

理論はわかった。でも実装になると難しく感じる。

そのギャップを埋めるためのページにしていくつもり。

---

## ①JSONとクラスの不一致問題

### よくある例

JSON：

```JSON
{
    "user_name":"Taro"
}
```

Java：

```java
private String name;
```

### なんで？

- フィールド名が一致していない

JSONとDTO（受け取り専用クラス）のフィールド名が一致していないと、  
正しく値を受け取ることができない。

REST APIでは通常：

- JSON ⇄ DTO（受け取りクラス）
- Entity ⇄ DBカラム

が対応する。

👉 JSONとDBが直接一致するわけではない。

---

## ②型の不一致エラー

JSON：

```JSON
{
    "age":"20"
}
```

Java：

```java
private int age;
```

→ 400エラー

文字列と数値は別物です。

「見た目が同じでも型は違う」ここでかなりハマってしまうらしい。

---

## ③null問題

- 想定外のnull
- 必須項目がnull
- DB保存時にエラー

対策：

- バリデーションを入れる
- Optionalの使い方を理解する
- 必須かどうかを設計時に決める

---

## ④インデントを信用しすぎる

JSONはインデントがなくても成立する。

つまり：
>見た目が綺麗でも構造が間違えている可能性はある。

必ず対応する`{}`と`[]`を意識するようにすべき。

---

## ⑤エラーメッセージを読まない

初心者あるあるだと思います。

実は：
>エラー文にはほぼ答えが書いてある。

- Which field?
- What  type?
- At which line?

英語で書いてあるけれど、読む癖をつけるようにした方が良いと自分は感じました。

どこにエラーが書いてあるのかを分かるようになると、エラーメッセージ全文を読む必要はなくなるので、
かなりエラーを見つけやすくなると思います。

---

⑥Controllerにロジックを書きすぎる

最初はこれでも動いてしまう。

でも：

- テストしづらい
- 再利用できない
- 修正が怖くなる

責務分離を意識するようにするべきらしい。

簡単に言うと、**役割分担で決めたことだけに集中させてあげよう**。

---

## ⑦ステータスコードを適当に返す

全部200にしてしまう問題。

でも未来は：

- 200 → 成功
- 201 → 作成成功
- 400 → リクエスト不正
- 404 → 見つからない
- 500 → サーバーエラー

ステータスコードはAPIの言語。

---

## ⑧「とりあえず動いた」で止まる

一番危ない。

- なんで動いた？
- どこで変換された？
- どこで保存された？

これらを説明できる状態が理解しておこう。

---

## デバック時の思考フロー

エラーが出たら：

1. どの層で止まっている？（Controller / Service / DB）
2. JSONは正しい？
3. 型は一致している？
4. nullは混ざっていない？

こんな感じで順番に切り分けることで、エラー箇所を絞りこみやすくしておこう。

---

### 自分メモ

- エラーは敵ではなくヒント
- 設計と構造のズレが原因になりやすい
- 層を意識すると整理できる

---

## まとめ

実務でハマるポイントは：

- 型
- null
- 設計のズレ
- 責務の混在

でも逆に言えば、ここを理解できればかなり強いらしい。

---

👈 前へ → :[08_よくある勘違い集](08_よくある勘違い.html)

👉 次へ → :[10_フロントエンドとAPIの関係](10_フロントエンドとAPIの関係.html)

---

👈 TOPへ → :[TOPページ](index.html)
